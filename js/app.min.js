(()=>{"use strict";!function(e){let t=new Image;t.onload=t.onerror=function(){!function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)}(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}(),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("form");function t(e){e.parentElement.classList.add("_error"),e.classList.add("_error")}function n(e){e.parentElement.classList.remove("_error"),e.classList.remove("_error")}function o(e){return!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(e.value)}e.addEventListener("submit",(async function(s){s.preventDefault();let r=function(e){let a=0;console.log(a);let l=document.querySelectorAll("._req");for(let e=0;e<l.length;e++){const s=l[e];n(s),s.classList.contains("_email")?o(s)&&(t(s),a++):"checkbox"===s.getAttribute("type")&&!1===s.checked?(t(s),a++):""===s.value&&(t(s),a++,console.log(a))}return a}(),i=new FormData(e);if(i.append("image",a.files[0]),0===r){e.classList.add("_sending");let t=await fetch("./sendmail.php",{method:"POST",body:i});if(t.ok){console.log(9);let n=await t.json();alert(n.message),l.innerHTML="",e.reset(),e.classList.remove("_sending")}else alert("Mistake")}else alert("Заполните обязательные поля")}));const a=document.getElementById("formImage"),l=document.getElementById("formPreview");a.addEventListener("change",(()=>{!function(e){if(console.log(e.type),console.log(a.value),["image/jpeg","image/png","image/gif"].includes(e.type)||(alert("Разрешены только изображения"),a.value=""),e.size>2097152)alert("Файл должен быть менее 2 МБ");else{var t=new FileReader;t.onload=function(e){l.innerHTML=`<img src="${e.target.result}" alt="Фото">`},t.onerror=function(e){alert("Ошибка")},t.readAsDataURL(e)}}(a.files[0])}))}))})();